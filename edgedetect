// Purpose: convert a clean stable level into a 1-clock pulse on a rising edge
// Auto-clears next clock
module edgedetect(clock, resetn, key_clean, key_pulse);
    input key_clean; // debounced stable level
    input clock, resetn;
    output reg key_pulse; // 1 clock on rising edge

    reg prev_level; // previous level for edge comparison
    always@(posedge clock) 
    begin
    if (!resetn)
    begin
        key_pulse <= 0;
        prev_level <= 0;
    end
    else
    begin
        // rising-edge one shot
        key_pulse <= key_clean & ~prev_level;
        prev_level <= key_clean;
    end
    end
endmodule